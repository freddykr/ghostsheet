<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Ghostsheet by mach3</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/mach3/ghostsheet">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/mach3/ghostsheet/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/mach3/ghostsheet/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Ghostsheet</h1>
          <p>Simple Google Spreadsheet Loader for PHP and Ajax</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/mach3">mach3</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a name="ghostsheet" class="anchor" href="#ghostsheet"><span class="octicon octicon-link"></span></a>Ghostsheet</h1>

<p>Simple Google Spreadsheet Loader for PHP and Ajax</p>

<h2>
<a name="feature" class="anchor" href="#feature"><span class="octicon octicon-link"></span></a>Feature</h2>

<ul>
<li>Load Google Spreadsheet and parse it to easy-to-read object data</li>
<li>Save it as cache file</li>
<li>Having an interface for Ajax or JSONP</li>
</ul><h2>
<a name="basic-usage" class="anchor" href="#basic-usage"><span class="octicon octicon-link"></span></a>Basic Usage</h2>

<h3>
<a name="create-spreadsheet" class="anchor" href="#create-spreadsheet"><span class="octicon octicon-link"></span></a>Create Spreadsheet</h3>

<p>Example :</p>

<table>
<tr>
<th>name</th>
            <th>age:integer</th>
            <th>email</th>
            <th>active:bool</th>
        </tr>
<tr>
<td>john</td>
            <td>18</td>
            <td>john@example.com</td>
            <td>true</td>
        </tr>
<tr>
<td>tom</td>
            <td>21</td>
            <td>tom@example.com</td>
            <td>false</td>
        </tr>
</table><ul>
<li>First row must be header consists of field name</li>
<li>If field name has data type (as <code>:string</code>), PHP try to juggle value to the type<br>
(If not set, value will be output as string)</li>
</ul><h3>
<a name="get-spreadsheet-id" class="anchor" href="#get-spreadsheet-id"><span class="octicon octicon-link"></span></a>Get Spreadsheet ID</h3>

<p>Get your spreadsheet id from URL</p>

<ol>
<li>Open "File" &gt; "Publish to the web" dialog</li>
<li>In "Get a link to the published data" section, select "RSS" and "Cells"</li>
<li>You can get url just like below</li>
</ol><pre><code>https://spreadsheets.google.com/feeds/cells/XXXXXXXXXXXXXXXXXXXXXX/YYY/public/basic?alt=rss
</code></pre>

<p>This <code>"XXXXXXXXXXXXXXXXXXXXXX/YYY"</code> is your sheet's ID</p>

<h3>
<a name="load-it" class="anchor" href="#load-it"><span class="octicon octicon-link"></span></a>Load it</h3>

<div class="highlight"><pre><span class="k">require</span> <span class="s2">"the/path/to/Ghostsheet.php"</span><span class="p">;</span>
<span class="nv">$gs</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Ghostsheet</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s2">"cacheDir"</span> <span class="o">=&gt;</span> <span class="s2">"./gscache/"</span>
<span class="p">));</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="nv">$gs</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s2">"XXXXXXXXXXXXXXXXXXXXXX/YYY"</span><span class="p">);</span>
</pre></div>

<p>Now, <code>$data</code> has array consists of spreadsheet contents.</p>

<div class="highlight"><pre><span class="k">array</span><span class="p">(</span>
    <span class="s2">"id"</span> <span class="o">=&gt;</span> <span class="s2">""</span><span class="nx">https</span><span class="o">://</span><span class="nx">spreadsheets</span><span class="o">.</span><span class="nx">google</span><span class="o">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">feeds</span><span class="o">/</span><span class="nx">cells</span><span class="o">/</span><span class="nx">XXXXXXXXXXXXXXXXXXXXXX</span><span class="o">/</span><span class="nx">YYY</span><span class="o">/</span><span class="k">public</span><span class="o">/</span><span class="nx">basic</span><span class="s2">""</span><span class="p">,</span>
    <span class="s2">"title"</span> <span class="o">=&gt;</span> <span class="s2">"mysheet"</span><span class="p">,</span> <span class="c1">// your sheet's name</span>
    <span class="s2">"updated"</span> <span class="o">=&gt;</span> <span class="s2">"2013-05-28T10:37:51.771Z"</span><span class="p">,</span>
    <span class="s2">"items"</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"John"</span><span class="p">,</span> <span class="s2">"age"</span> <span class="o">=&gt;</span> <span class="mi">18</span><span class="p">,</span> <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"john@example.com"</span><span class="p">,</span> <span class="s2">"active"</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">),</span>
        <span class="o">...</span>
    <span class="p">)</span>
<span class="p">);</span>
</pre></div>

<h2>
<a name="ajax" class="anchor" href="#ajax"><span class="octicon octicon-link"></span></a>Ajax</h2>

<p>Ghostsheet has an interface for AJAX request.</p>

<div class="highlight"><pre><span class="c1"># ajax.php</span>
<span class="nv">$gs</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Ghostsheet</span><span class="p">();</span>
<span class="nv">$gs</span><span class="o">-&gt;</span><span class="na">ajax</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">);</span>
</pre></div>

<p>This will response JSON for the passed parameter.
If no arguments, this uses $_GET as default.</p>

<p>Example for jQuery :</p>

<pre><code>$.getJSON("ajax.php", {id : "XXXXXXXXXX/YYY", cache : false})
.then(function(data){
    var items = data.items;
});
</code></pre>

<h2>
<a name="configure" class="anchor" href="#configure"><span class="octicon octicon-link"></span></a>Configure</h2>

<p>Configure options with <code>config()</code> or <code>set()</code>.</p>

<div class="highlight"><pre><span class="nv">$gs</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s2">"cacheDir"</span><span class="p">,</span> <span class="s2">"./mycache/"</span><span class="p">);</span>
<span class="nv">$gs</span><span class="o">-&gt;</span><span class="na">config</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">"timeout"</span><span class="p">,</span> <span class="mi">60</span><span class="p">));</span>
</pre></div>

<h2>
<a name="api-doc" class="anchor" href="#api-doc"><span class="octicon octicon-link"></span></a>API Doc</h2>

<p>» <a href="doc/api.md">Learn More About Ghostsheet</a></p>

<h2>
<a name="change-log" class="anchor" href="#change-log"><span class="octicon octicon-link"></span></a>Change Log</h2>

<p>» <a href="doc/changelog.md">Change Log</a></p>

<hr><h2>
<a name="author" class="anchor" href="#author"><span class="octicon octicon-link"></span></a>Author</h2>

<p>mach3</p>

<ul>
<li><a href="http://www.mach3.jp">Website</a></li>
<li><a href="http://blog.mach3.jp">Blog</a></li>
<li><a href="http://twitter.com/mach3ss">Twitter</a></li>
</ul>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>